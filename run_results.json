{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2025.2.20+a9cc190", "generated_at": "2025-02-24T04:06:14.787944Z", "invocation_id": "553bc19f-ce5a-497e-aa14-84b77ddff78f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:12.401931Z", "completed_at": "2025-02-24T04:06:13.367582Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.368051Z", "completed_at": "2025-02-24T04:06:13.368060Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.9670639038085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.stg_raw_retail_data__transactions", "compiled": true, "compiled_code": "with source as (\n    select * from dbt_assignment1.raw_retail_data.transactions\n),\n\ncleaned as (\n    select\n    invoiceno as invoice_no, \n    stockcode as stock_code, \n    trim(description) as description, \n    quantity, \n    TO_DATE(invoicedate) AS invoice_date,\n    unitprice as unit_price, \n    customerid as customer_id, \n    country\nfrom source\nwhere\n    left(invoice_no, 1) != 'C' \n    and\n    quantity > 0 \n    and\n    unit_price > 0 \n    and\n    COUNTRY is not null\n    and\n    UNITPRICE is not null\n    and\n    STOCKCODE is not null\n    and\n    INVOICEDATE is not null\n    and\n    QUANTITY is not null\n    and\n    CUSTOMERID is not null\n    and\n    DESCRIPTION is not null\n    and\n    INVOICENO is not null\n    and \n    stock_code rlike '^[0-9]+$'\n    and \n    invoice_date > (select max(invoice_date) from DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions)\n    \n)\n\nselect * from cleaned", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.376908Z", "completed_at": "2025-02-24T04:06:13.390108Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.401960Z", "completed_at": "2025-02-24T04:06:13.401969Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.031098365783691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.fct_sales", "compiled": true, "compiled_code": "\n\nwith sales as (\n    select\n        invoice_no,\n        stock_code,\n        description,\n        customer_id,\n        invoice_date,\n        quantity,\n        unit_price,\n        round((quantity * unit_price), 2) as revenue\n    from DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\n    \n    where invoice_date > (select max(invoice_date) from DBT_ASSIGNMENT1.dbt_afalari.fct_sales)\n    \n)\n\nselect * from sales", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.fct_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.381395Z", "completed_at": "2025-02-24T04:06:13.400858Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.404041Z", "completed_at": "2025-02-24T04:06:13.404049Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.03116917610168457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.int_customer_lifetime", "compiled": true, "compiled_code": "with transactions as (\n    select * from DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\n),\n\ncustomer_lifetime as (\n    select\n        customer_id,\n        min(invoice_date) as first_purchase,\n        max(invoice_date) as latest_purchase,\n        datediff(day, min(invoice_date), max(invoice_date)) as customer_lifetime_days\n    from transactions\n    group by customer_id\n)\n\nselect * from customer_lifetime", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.383067Z", "completed_at": "2025-02-24T04:06:13.401397Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.405274Z", "completed_at": "2025-02-24T04:06:13.405282Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.03182077407836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.int_customer_spendings", "compiled": true, "compiled_code": "with transactions as (\n    select\n        customer_id,\n        country,\n        invoice_date,\n        quantity,\n        unit_price,\n        invoice_no\n    from DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\n),\n\nlatest_country as (\n    select distinct customer_id, country\n    from (\n        select \n            customer_id, \n            country, \n            invoice_date, \n            row_number() over (partition by customer_id order by invoice_date desc) as rn\n        from transactions\n    ) \n    where rn = 1\n),\n\ncustomer_spendings as (\n    select\n        customer_id,\n        round(sum(quantity * unit_price), 2) as total_amount_spent,\n        count(distinct invoice_no) as total_orders\n    from transactions\n    group by customer_id\n),\n\ncustomer_spending as (\n    select \n        lc.customer_id,\n        lc.country as latest_country,\n        cs.total_amount_spent,\n        cs.total_orders\n    from latest_country lc\n    join customer_spendings cs \n        on lc.customer_id = cs.customer_id\n    order by total_amount_spent desc\n)\n\nselect * from customer_spending", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.384813Z", "completed_at": "2025-02-24T04:06:13.402793Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.406781Z", "completed_at": "2025-02-24T04:06:13.406787Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.03234243392944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Country.b419a95bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Country\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.390551Z", "completed_at": "2025-02-24T04:06:13.403497Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.407584Z", "completed_at": "2025-02-24T04:06:13.407591Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.03254127502441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Customer_ID.25f25a329f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Customer_ID\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Customer_ID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.395635Z", "completed_at": "2025-02-24T04:06:13.404827Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.408989Z", "completed_at": "2025-02-24T04:06:13.408996Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.03346538543701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Description.38aae6917d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Description\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.415764Z", "completed_at": "2025-02-24T04:06:13.442907Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.447746Z", "completed_at": "2025-02-24T04:06:13.447754Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.03748369216918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Invoice_Date.3f5c17981e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Invoice_Date\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Invoice_Date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.421738Z", "completed_at": "2025-02-24T04:06:13.445631Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.448648Z", "completed_at": "2025-02-24T04:06:13.448654Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.036907196044921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Invoice_No.c7ce872dbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Invoice_No\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Invoice_No is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.427835Z", "completed_at": "2025-02-24T04:06:13.446380Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.449933Z", "completed_at": "2025-02-24T04:06:13.449940Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.037256717681884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Quantity.8270901a05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Quantity\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.432857Z", "completed_at": "2025-02-24T04:06:13.446880Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.450697Z", "completed_at": "2025-02-24T04:06:13.450702Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.037143707275390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Stock_Code.f890a7de72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Stock_Code\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Stock_Code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.437824Z", "completed_at": "2025-02-24T04:06:13.447321Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.451454Z", "completed_at": "2025-02-24T04:06:13.451460Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.037489891052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_stg_raw_retail_data__transactions_Unit_Price.7ab8aa8b44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Unit_Price\nfrom DBT_ASSIGNMENT1.dbt_afalari.stg_raw_retail_data__transactions\nwhere Unit_Price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.443501Z", "completed_at": "2025-02-24T04:06:13.449468Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.453222Z", "completed_at": "2025-02-24T04:06:13.453228Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.03843092918395996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.dim_products", "compiled": true, "compiled_code": "\n\nwith latest_unit_price as (\n    select\n        stock_code,\n        description,\n        unit_price,\n        invoice_date,\n        row_number() over (partition by stock_code order by invoice_date desc) as row_num\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_sales\n),\ntotal_sold as (\n    select\n        stock_code,\n        sum(quantity) as total_quantity_sold,\n        round(sum(revenue), 2) as total_revenue\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_sales\n    group by stock_code\n),\nprice_range as (\n    select\n        stock_code,\n        max(unit_price) as max_unit_price,\n        min(unit_price) as min_unit_price\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_sales\n    group by stock_code\n),\nproducts as (\n    select \n        l.stock_code,\n        l.description,\n        l.unit_price as latest_unit_price,\n        p.max_unit_price as highest_unit_price,\n        p.min_unit_price as lowest_unit_price,\n        t.total_quantity_sold,\n        t.total_revenue\n    from latest_unit_price l\n    left join total_sold t on l.stock_code = t.stock_code\n    left join price_range p on l.stock_code = p.stock_code\n    where l.row_num = 1\n)\n\nselect * from products", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.460928Z", "completed_at": "2025-02-24T04:06:13.488947Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.491580Z", "completed_at": "2025-02-24T04:06:13.491588Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.03619837760925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.negative_revenue", "compiled": true, "compiled_code": "with negative_revenue as (\n    select \n        revenue  \n    from DBT_ASSIGNMENT1.dbt_afalari.fct_sales\n    where revenue < 0\n)\n\nselect * from negative_revenue", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.462749Z", "completed_at": "2025-02-24T04:06:13.489497Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.492828Z", "completed_at": "2025-02-24T04:06:13.492835Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.036985158920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_customer_id.998bfce0ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.473867Z", "completed_at": "2025-02-24T04:06:13.490206Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.493600Z", "completed_at": "2025-02-24T04:06:13.493606Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.03618955612182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_invoice_date.40170d736f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_date\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere invoice_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.468653Z", "completed_at": "2025-02-24T04:06:13.490642Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.494352Z", "completed_at": "2025-02-24T04:06:13.494357Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.03740715980529785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_description.3d3ad2cccc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.478742Z", "completed_at": "2025-02-24T04:06:13.491146Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.495093Z", "completed_at": "2025-02-24T04:06:13.495099Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.037278175354003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_invoice_no.8773fc49e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoice_no\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere invoice_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.483966Z", "completed_at": "2025-02-24T04:06:13.492396Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.496370Z", "completed_at": "2025-02-24T04:06:13.496377Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.03719305992126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_quantity.a4800a70aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.504953Z", "completed_at": "2025-02-24T04:06:13.539433Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.542803Z", "completed_at": "2025-02-24T04:06:13.542812Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.043700456619262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_revenue.0452ff4e0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.510784Z", "completed_at": "2025-02-24T04:06:13.540257Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.543626Z", "completed_at": "2025-02-24T04:06:13.543632Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.043279409408569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_stock_code.270eaae826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_code\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere stock_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.517453Z", "completed_at": "2025-02-24T04:06:13.540841Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.544407Z", "completed_at": "2025-02-24T04:06:13.544415Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.043592214584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_sales_unit_price.9b1b644216", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unit_price\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_sales\nwhere unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.523836Z", "completed_at": "2025-02-24T04:06:13.541335Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.545176Z", "completed_at": "2025-02-24T04:06:13.545181Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.0438687801361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_lifetime_customer_id.8395766c61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.534142Z", "completed_at": "2025-02-24T04:06:13.541846Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.545910Z", "completed_at": "2025-02-24T04:06:13.545917Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.043238162994384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_lifetime_first_purchase.8af8515ef6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_purchase\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\nwhere first_purchase is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.528948Z", "completed_at": "2025-02-24T04:06:13.542290Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.546672Z", "completed_at": "2025-02-24T04:06:13.546678Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.044910430908203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_lifetime_customer_lifetime_days.295984a44e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_lifetime_days\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\nwhere customer_lifetime_days is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.555502Z", "completed_at": "2025-02-24T04:06:13.582674Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.585179Z", "completed_at": "2025-02-24T04:06:13.585186Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.034929513931274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_lifetime_latest_purchase.b1efb733c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latest_purchase\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\nwhere latest_purchase is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.560636Z", "completed_at": "2025-02-24T04:06:13.583155Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.586421Z", "completed_at": "2025-02-24T04:06:13.586427Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.03570199012756348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_int_customer_lifetime_customer_id.f2b1258484", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.565555Z", "completed_at": "2025-02-24T04:06:13.583832Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.587200Z", "completed_at": "2025-02-24T04:06:13.587207Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.03601217269897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.fct_rfm", "compiled": true, "compiled_code": "with customer_spending as (\n    select\n        customer_id,\n        total_amount_spent,\n        total_orders\n    from DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\n),\n\nlatest_purchase as (\n    select\n        customer_id,\n        latest_purchase\n    from DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\n),\n\ncurrent_date as (\n    select max(invoice_date) as today from DBT_ASSIGNMENT1.dbt_afalari.fct_sales\n),\n\nrfm as (\n    select\n        c.customer_id,\n        datediff(day, l.latest_purchase, cd.today) as recency,\n        c.total_orders as frequency,\n        c.total_amount_spent as monetary_value\n    from customer_spending c\n    join latest_purchase l on c.customer_id = l.customer_id\n    join current_date cd on 1=1\n)\n\nselect * from rfm", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.fct_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.567528Z", "completed_at": "2025-02-24T04:06:13.584249Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.587987Z", "completed_at": "2025-02-24T04:06:13.587992Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.036344051361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_spendings_customer_id.75ab0d130a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.572529Z", "completed_at": "2025-02-24T04:06:13.584716Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.588687Z", "completed_at": "2025-02-24T04:06:13.588693Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.03664827346801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_spendings_latest_country.9e36be6276", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latest_country\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\nwhere latest_country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.577409Z", "completed_at": "2025-02-24T04:06:13.585994Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.589960Z", "completed_at": "2025-02-24T04:06:13.589966Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.03748583793640137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_spendings_total_amount_spent.efd12d4366", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount_spent\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\nwhere total_amount_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.598362Z", "completed_at": "2025-02-24T04:06:13.629630Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.632303Z", "completed_at": "2025-02-24T04:06:13.632310Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.039594173431396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_int_customer_spendings_total_orders.0af62ce352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.604684Z", "completed_at": "2025-02-24T04:06:13.630169Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.633555Z", "completed_at": "2025-02-24T04:06:13.633561Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.03989148139953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_int_customer_spendings_customer_id.4795679f74", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.609573Z", "completed_at": "2025-02-24T04:06:13.630810Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.634332Z", "completed_at": "2025-02-24T04:06:13.634338Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.040200233459472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_description.ee2a8bcef5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.614462Z", "completed_at": "2025-02-24T04:06:13.631370Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.635104Z", "completed_at": "2025-02-24T04:06:13.635109Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.040512800216674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_highest_unit_price.a2fdf114ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect highest_unit_price\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere highest_unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.619377Z", "completed_at": "2025-02-24T04:06:13.631858Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.635806Z", "completed_at": "2025-02-24T04:06:13.635812Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.04077434539794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_latest_unit_price.59466dbc01", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latest_unit_price\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere latest_unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.624413Z", "completed_at": "2025-02-24T04:06:13.633128Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.637117Z", "completed_at": "2025-02-24T04:06:13.637123Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.0411686897277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_lowest_unit_price.dc7850f286", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lowest_unit_price\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere lowest_unit_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.645415Z", "completed_at": "2025-02-24T04:06:13.672687Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.675442Z", "completed_at": "2025-02-24T04:06:13.675449Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.03565049171447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_stock_code.be4e9f421c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_code\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere stock_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.651157Z", "completed_at": "2025-02-24T04:06:13.673415Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.676655Z", "completed_at": "2025-02-24T04:06:13.676661Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.03568148612976074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_products_total_quantity_sold.fdec65104a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_quantity_sold\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere total_quantity_sold is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.656050Z", "completed_at": "2025-02-24T04:06:13.673921Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.677422Z", "completed_at": "2025-02-24T04:06:13.677428Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.03598833084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_dim_products_stock_code.249bcf00aa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stock_code as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_products\nwhere stock_code is not null\ngroup by stock_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.660900Z", "completed_at": "2025-02-24T04:06:13.674431Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.678164Z", "completed_at": "2025-02-24T04:06:13.678170Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.036283016204833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.fct_customer_segmentations", "compiled": true, "compiled_code": "with rfm as (\n    select\n        customer_id,\n        recency,\n        frequency,\n        monetary_value\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\n),\n\nrfm_score as (\n    select\n        customer_id,\n        recency,\n        frequency,\n        monetary_value,\n        ntile(4) over (order by recency asc) as recency_score, \n        ntile(4) over (order by frequency desc) as frequency_score,\n        ntile(4) over (order by monetary_value desc) as monetary_score\n    from rfm\n),\n\nrfm_tiers as (\n    select\n        customer_id,\n        recency, \n        concat('R-tier-', recency_score) as recency_tier,\n        frequency, \n        concat('F-tier-', frequency_score) as frequency_tier,\n        monetary_value,\n        concat('M-tier-', monetary_score) as monetary_tier,\n        recency_score,\n        frequency_score,\n        monetary_score\n    from rfm_score\n),\n\ncustomer_segments as (\n    select\n        customer_id,\n        recency,\n        recency_tier,\n        frequency,\n        frequency_tier,\n        monetary_value,\n        monetary_tier,\n        case \n            when recency_score = 1 and frequency_score = 1 and monetary_score = 1 then 'Best Customer'\n            when recency_score = 1 and frequency_score = 4 and monetary_score in (1, 2) then 'High-Spending New Customer'\n            when recency_score = 1 and frequency_score = 1 and monetary_score in (3, 4) then 'Lowest-Spending Active Loyal Customer'\n            when recency_score = 4 and frequency_score in (1, 2) and monetary_score in (1, 2) then 'Churned Best Customer'\n            else 'Normal Customer'\n        end as customer_segment\n    from rfm_tiers\n)\n\nselect * from customer_segments", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.662531Z", "completed_at": "2025-02-24T04:06:13.674996Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.678874Z", "completed_at": "2025-02-24T04:06:13.678880Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.03662228584289551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_rfm_customer_id.676cd6231e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.667665Z", "completed_at": "2025-02-24T04:06:13.676230Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.680161Z", "completed_at": "2025-02-24T04:06:13.680167Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.03693652153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_rfm_frequency.ba1559ddb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.688451Z", "completed_at": "2025-02-24T04:06:13.719380Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.722238Z", "completed_at": "2025-02-24T04:06:13.722245Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.03911423683166504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_rfm_monetary_value.08e1ff3503", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.699709Z", "completed_at": "2025-02-24T04:06:13.720233Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.723512Z", "completed_at": "2025-02-24T04:06:13.723519Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.039011478424072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_fct_rfm_customer_id.39e4dea171", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.694712Z", "completed_at": "2025-02-24T04:06:13.720666Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.724264Z", "completed_at": "2025-02-24T04:06:13.724270Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.040196895599365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_rfm_recency.e1e5aacea6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_rfm\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.706749Z", "completed_at": "2025-02-24T04:06:13.721103Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.725011Z", "completed_at": "2025-02-24T04:06:13.725016Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.04007315635681152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.assignment1.dim_customers", "compiled": true, "compiled_code": "\n\nwith customer_lifetime as (\n    select\n        customer_id,\n        first_purchase,\n        latest_purchase\n    from DBT_ASSIGNMENT1.dbt_afalari.int_customer_lifetime\n),\ncustomer_spendings as (\n    select\n        customer_id,\n        latest_country,\n        total_amount_spent,\n        total_orders\n    from DBT_ASSIGNMENT1.dbt_afalari.int_customer_spendings\n),\ncustomer_segments as (\n    select\n        customer_id,\n        customer_segment\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\n),\ncustomers as (\n    select\n        cl.customer_id,\n        cl.first_purchase,\n        cl.latest_purchase,\n        cs.latest_country,\n        cs.total_amount_spent,\n        cs.total_orders,\n        seg.customer_segment\n    from customer_lifetime cl\n    join customer_spendings cs on cl.customer_id = cs.customer_id\n    join customer_segments seg on cl.customer_id = seg.customer_id\n)\nselect * from customers", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.708944Z", "completed_at": "2025-02-24T04:06:13.721792Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.725773Z", "completed_at": "2025-02-24T04:06:13.725779Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.04035758972167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.accepted_values_fct_customer_segmentations_customer_segment__Best_Customer__High_Spending_New_Customer__Lowest_Spending_Active_Loyal_Customer__Churned_Best_Customer__Normal_Customer.59bfb494c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Best Customer','High-Spending New Customer','Lowest-Spending Active Loyal Customer','Churned Best Customer','Normal Customer'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.714270Z", "completed_at": "2025-02-24T04:06:13.723090Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.727139Z", "completed_at": "2025-02-24T04:06:13.727145Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.04089212417602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_customer_id.e20da62a9f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.735314Z", "completed_at": "2025-02-24T04:06:13.766200Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.769850Z", "completed_at": "2025-02-24T04:06:13.769858Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.03991508483886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_customer_segment.e8b0f0fc99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.740910Z", "completed_at": "2025-02-24T04:06:13.767600Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.771134Z", "completed_at": "2025-02-24T04:06:13.771141Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.04019904136657715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_frequency.84a14bf64f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.745802Z", "completed_at": "2025-02-24T04:06:13.768236Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.771936Z", "completed_at": "2025-02-24T04:06:13.771943Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.04057192802429199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_frequency_tier.60db3f8377", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_tier\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere frequency_tier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.750741Z", "completed_at": "2025-02-24T04:06:13.768761Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.772715Z", "completed_at": "2025-02-24T04:06:13.772722Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.04090118408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_monetary_tier.cbcaa0fb1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_tier\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere monetary_tier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.755671Z", "completed_at": "2025-02-24T04:06:13.769420Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.773471Z", "completed_at": "2025-02-24T04:06:13.773477Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.04123544692993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_monetary_value.322aa80bd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.761137Z", "completed_at": "2025-02-24T04:06:13.770622Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.774761Z", "completed_at": "2025-02-24T04:06:13.774767Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.04166555404663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_recency.5a8f10c995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.794705Z", "completed_at": "2025-02-24T04:06:13.796382Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.807806Z", "completed_at": "2025-02-24T04:06:13.807812Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.028635740280151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.assignment1.dim_customer_snapshot", "compiled": true, "compiled_code": "\n\n\n\n\n\nselect * from DBT_ASSIGNMENT1.dbt_afalari.dim_customers\n", "relation_name": "DBT_ASSIGNMENT1.dbt_afalari_snapshot.dim_customer_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.782582Z", "completed_at": "2025-02-24T04:06:13.807140Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.809728Z", "completed_at": "2025-02-24T04:06:13.809734Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.032376766204833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_fct_customer_segmentations_recency_tier.ece27484a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_tier\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere recency_tier is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.788139Z", "completed_at": "2025-02-24T04:06:13.808589Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.811868Z", "completed_at": "2025-02-24T04:06:13.811874Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.033597469329833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.rfm_score_validation", "compiled": true, "compiled_code": "with invalid_tiers as (\n    select \n        customer_id, \n        recency_tier, \n        frequency_tier, \n        monetary_tier\n    from DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\n    where recency_tier not in ('R-tier-1', 'R-tier-2', 'R-tier-3', 'R-tier-4')\n       or frequency_tier not in ('F-tier-1', 'F-tier-2', 'F-tier-3', 'F-tier-4')\n       or monetary_tier not in ('M-tier-1', 'M-tier-2', 'M-tier-3', 'M-tier-4')\n)\n\nselect * from invalid_tiers", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.789721Z", "completed_at": "2025-02-24T04:06:13.809047Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.812612Z", "completed_at": "2025-02-24T04:06:13.812618Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.033916473388671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_fct_customer_segmentations_customer_id.cd43ffe904", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.fct_customer_segmentations\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.796836Z", "completed_at": "2025-02-24T04:06:13.810484Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.813821Z", "completed_at": "2025-02-24T04:06:13.813827Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.0342257022857666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.802065Z", "completed_at": "2025-02-24T04:06:13.811371Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.815035Z", "completed_at": "2025-02-24T04:06:13.815041Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.0346071720123291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.820228Z", "completed_at": "2025-02-24T04:06:13.832639Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.854409Z", "completed_at": "2025-02-24T04:06:13.854416Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.039966583251953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_first_purchase.acac4edc63", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_purchase\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere first_purchase is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.826670Z", "completed_at": "2025-02-24T04:06:13.848920Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.856902Z", "completed_at": "2025-02-24T04:06:13.856908Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.04030632972717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_latest_country.7143014b33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latest_country\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere latest_country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.833059Z", "completed_at": "2025-02-24T04:06:13.855587Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.858365Z", "completed_at": "2025-02-24T04:06:13.858371Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.04001736640930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_latest_purchase.9f403d00f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect latest_purchase\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere latest_purchase is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.838001Z", "completed_at": "2025-02-24T04:06:13.856283Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.859647Z", "completed_at": "2025-02-24T04:06:13.859653Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.04088330268859863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_total_amount_spent.6081755eed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount_spent\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere total_amount_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.843154Z", "completed_at": "2025-02-24T04:06:13.857648Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.860492Z", "completed_at": "2025-02-24T04:06:13.860498Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.04082059860229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.not_null_dim_customers_total_orders.6e18bb41d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-24T04:06:13.849384Z", "completed_at": "2025-02-24T04:06:13.859185Z"}, {"name": "execute", "started_at": "2025-02-24T04:06:13.861347Z", "completed_at": "2025-02-24T04:06:13.861353Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.0361180305480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.assignment1.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_ASSIGNMENT1.dbt_afalari.dim_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.7745778560638428, "args": {"favor_state": false, "invocation_command": "dbt -A dbt_worker.app worker --loglevel=DEBUG --concurrency=2 --max-memory-per-child=500000", "project_dir": "/usr/src/develop/user-70471823423190/environment-70471823423649/repository-70471823411272", "which": "generate", "introspect": true, "use_colors": true, "select": [], "indirect_selection": "eager", "static": false, "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "log_format_file": "json", "strict_mode": false, "populate_cache": true, "static_parser": true, "quiet": false, "partial_parse": true, "source_freshness_run_project_hooks": false, "use_colors_file": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "profile": "user", "empty_catalog": false, "log_file_max_bytes": 0, "show_resource_report": false, "state_modified_compare_vars": false, "write_json": true, "version_check": true, "compile": true, "log_path": "/usr/src/dbt-server-shared/working_dir/36009193-9c43-4d2a-8648-697593ef9724", "log_level": "info", "cache_selected_only": false, "send_anonymous_usage_stats": true, "skip_write_msgpack_if_exist": false, "state_modified_compare_more_unrendered_values": false, "partial_parse_file_diff": true, "log_format": "json", "printer_width": 80, "profiles_dir": "/usr/src/dbt-server-shared/.dbt", "defer": false, "log_level_file": "debug", "skip_nodes_if_on_run_start_fails": false, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": false, "exclude": [], "use_fast_test_edges": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true}}